<div class="container mt-4">
  <h2>Gesti√≥n de Pacientes</h2>

  <div class="top-bar">
  <!-- üîπ B√∫squeda local: nombre o c√©dula -->
  <input
    type="text"
    placeholder="Buscar por nombre o c√©dula..."
    [(ngModel)]="searchTerm"
  />
  <button class="btn-add" (click)="openModal()">Inscribir Paciente</button>
</div>

<!-- üîπ Nueva secci√≥n: b√∫squeda por ID (usa GET del backend) -->
<div class="search-id-bar">
  <input
    type="text"
    placeholder="Ingrese el ID del paciente..."
    [(ngModel)]="searchId"
  />

  <button class="btn-id-search" (click)="buscarPorId()">Buscar por ID</button>
  <button class="btn-view-all" (click)="verTodos()">Ver todos</button>
</div>

  <table class="table table-striped align-middle text-center">
    <thead>
      <tr>
        <th>ID</th>
        <th>Nombre</th>
        <th>C√©dula</th>
        <th>Correo</th>
        <th>Tel√©fono</th>
        <th>Direcci√≥n</th>
        <th>Fecha de nacimiento</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let paciente of filteredPacientes">
        <td>{{ paciente.idPaciente }}</td>
        <td>{{ paciente.nombrePaciente }}</td>
        <td>{{ paciente.cedulaPaciente }}</td>
        <td>{{ paciente.correoPaciente }}</td>
        <td>{{ paciente.telefonoPaciente }}</td>
        <td>{{ paciente.direccionPaciente }}</td>
        <td>{{ paciente.fechaNacimiento | date: 'yyyy-MM-dd' }}</td>
        <td>
          <button class="btn btn-sm btn-warning me-2" (click)="openModal(paciente)">‚úèÔ∏è</button>
          <button
            class="btn btn-sm btn-danger"
            *ngIf="paciente.idPaciente"
            (click)="deletePaciente(paciente.idPaciente)">
            üóëÔ∏è
          </button>
        </td>
      </tr>
    </tbody>
  </table>
  <!-- CONTROLES DE PAGINADO -->
<nav class="pagination-container" *ngIf="pacientes.length">
  <ul class="pagination">
    <li class="page-item" [class.disabled]="currentPage === 1">
      <button class="page-link" (click)="prevPage()" [disabled]="currentPage === 1">
        ‚¨ÖÔ∏è Anterior
      </button>
    </li>

    <li class="page-item active">
      <span class="page-link">P√°gina {{ currentPage }}</span>
    </li>

    <li class="page-item">
      <button class="page-link" (click)="nextPage()">
        Siguiente ‚û°Ô∏è
      </button>
    </li>
  </ul>
</nav>

  <!-- MODAL -->
  <div class="modal" *ngIf="showModal">
    <div class="modal-content">
      <h3>{{ editMode ? 'Editar Paciente' : 'Inscribir Paciente' }}</h3>

      <form (ngSubmit)="savePaciente()">
        <label>Nombre completo:</label>
        <input
          type="text"
          [(ngModel)]="selectedPaciente.nombrePaciente"
          name="nombrePaciente"
          required />

        <label>C√©dula:</label>
        <input
          type="text"
          [(ngModel)]="selectedPaciente.cedulaPaciente"
          name="cedulaPaciente" />

        <label>Correo:</label>
        <input
          type="email"
          [(ngModel)]="selectedPaciente.correoPaciente"
          name="correoPaciente"
          required />

        <label>Tel√©fono:</label>
        <input
          type="text"
          [(ngModel)]="selectedPaciente.telefonoPaciente"
          name="telefonoPaciente" />

        <label>Direcci√≥n:</label>
        <input
          type="text"
          [(ngModel)]="selectedPaciente.direccionPaciente"
          name="direccionPaciente" />

        <label>Fecha de nacimiento:</label>
        <input
          type="date"
          [(ngModel)]="selectedPaciente.fechaNacimiento"
          name="fechaNacimiento" />

        <div class="actions">
          <button
            type="button"
            class="btn-cancel"
            (click)="closeModal()">
            Cancelar
          </button>
          <button
            type="submit"
            class="btn btn-success">
            Guardar
          </button>
        </div>
      </form>
    </div>
  </div>
</div>