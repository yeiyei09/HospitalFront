<div class="container mt-4">
  <h2>Gesti√≥n de Citas</h2>

  <div class="top-bar">
    <input type="text" placeholder="Buscar por ID, paciente o m√©dico..." [(ngModel)]="searchTerm" />
    <button class="btn-add" (click)="openModal()">Registrar Cita</button>
  </div>

  <table class="table table-striped align-middle text-center">
    <thead>
      <tr>
        <th>ID Cita</th>
        <th>ID Paciente</th>
        <th>ID M√©dico</th>
        <th>Fecha Agendamiento</th>
        <th>Motivo</th>
        <th>Fecha Emisi√≥n</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let cita of filteredCitas">
        <td>{{ cita.idCita }}</td>
        <td>{{ cita.idPaciente }}</td>
        <td>{{ cita.idMedico }}</td>
        <td>{{ cita.fechaAgendamiento }}</td>
        <td>{{ cita.motivoConsulta }}</td>
        <td>{{ cita.fechaEmision }}</td>
        <td>
          <button class="btn btn-sm btn-warning me-2" (click)="openModal(cita)">‚úèÔ∏è</button>
          <button class="btn btn-sm btn-danger" (click)="deleteCita(cita.idCita!)">üóëÔ∏è</button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- MODAL -->
  <div class="modal" *ngIf="showModal">
    <div class="modal-content">
      <h3>{{ editMode ? 'Editar Cita' : 'Registrar Cita' }}</h3>
      <form (ngSubmit)="saveCita()">
        <label>ID Cita:</label>
        <input type="text" [(ngModel)]="selectedCita.idCita" name="idCita" required [readonly]="editMode" />

        <label>ID Paciente:</label>
        <input type="text" [(ngModel)]="selectedCita.idPaciente" name="idPaciente" required />

        <label>ID M√©dico:</label>
        <input type="text" [(ngModel)]="selectedCita.idMedico" name="idMedico" required />

        <label>Fecha de Agendamiento:</label>
        <input type="datetime-local" [(ngModel)]="selectedCita.fechaAgendamiento" name="fechaAgendamiento" required />

        <label>Motivo de la Consulta:</label>
        <input type="text" [(ngModel)]="selectedCita.motivoConsulta" name="motivoConsulta" required />

        <label>Fecha de Emisi√≥n:</label>
        <input type="date" [(ngModel)]="selectedCita.fechaEmision" name="fechaEmision" required />

        <div class="actions">
          <button type="button" class="btn-cancel" (click)="closeModal()">Cancelar</button>
          <button type="submit" class="btn btn-success">Registrar</button>
        </div>
      </form>
    </div>
  </div>
</div>
